FGO.minimize_manager=function(){function tt(n){i=n}function it(n){e=n;i.set_event(n)}function rt(n){r=n;h=i.get_specify_quest_list({get_CP:!1,schedule:!0,item:!0,event:!0});c=i.get_specify_item2quest_list({get_CP:!1,schedule:!0,item:!0,event:!0});ut()}function ut(){var n={};for(var t in r)n[t]=c[t];ft(n)}function ft(n){function d(){for(var f=!1,t,n,o,u,a;!f;){for(u in i.item_list){t=i.item_list[u];item2quest=c[t];e.push(t);s[t]||(s[t]=!0);for(a in item2quest)if(n=item2quest[a].type,l[n[0]]&&l[n[0]][n[1]])continue;else l[n[0]]||(l[n[0]]={}),l[n[0]][n[1]]=1,i.quest_list.push(n)}if(i.item_list.length===0)f=!0;else{i.item_list=[];for(u in i.quest_list){n=i.quest_list[u];o=h[n[0]][n[1]];for(t in o.drop_list)r[t]&&!s[t]&&(s[t]=!0,i.item_list.push(t))}}}}var c=n,i={item_list:[],quest_list:[]},l={},s={},e=[],a=[],f,b,k,u,o,v,y,w,p,g;for(u in c)s[u]=!1;for(u in c)s[u]||(i.item_list=[],i.quest_list=[],e=[],i.item_list.push(u),d(),a.push(e));for(f={},v=[];t.length;)t.pop();for(e in a){p=!1;f={};v=[];for(b in a[e]){u=a[e][b];for(k in c[u])o=c[u][k],f[o.type[0]]||(f[o.type[0]]={}),f[o.type[0]][o.type[1]]||(f[o.type[0]][o.type[1]]=1)}for(y in f)for(w in f[y])v.push([y,w]),p=!0;p?t.push({item_list:a[e],quest_list:v}):g=0}}function et(n){f=n;y=0;b()}function b(){n=0;l=t.length;a.length=0;l?k():f&&f({times_list:{},AP:0,item_list:{}})}function k(){var u,i,f={},o;for(u in t[n].item_list)i=t[n].item_list[u],f[i]=r[i];t[n].quest_list.length&&(o=st({team:t[n],quest_list:h,item2quest_list:c,target_items:f,event:e}),s.postMessage({data:o,ver:FGO.ver,isWebSite:FGO.isWebSite}))}function ot(){function ct(n){var t=n.split("/");return t.length===2?t[0]/t[1]:Number(t)}var et,l,h,ot,n,k={},o={},d={},g={},st,nt=!0,c,tt,it,p,rt,ut,ft,s;for(tt in a){et=a[tt];l=et.match(/q\d+ = [\d\/]+/g);for(it in l)ot=Number(l[it].match(/\d+/ig)[0]),h=ct(l[it].replace(/q\d+ = /,"")),h&&(n=t[tt].quest_list[ot],k[n[0]]||(k[n[0]]={},o[n[0]]={},d[n[0]]={},g[n[0]]={}),k[n[0]][n[1]]=h,o[n[0]][n[1]]=Math.floor(h),d[n[0]][n[1]]=Math.ceil(h)-o[n[0]][n[1]],g[n[0]][n[1]]=Math.ceil(h))}if(p=!1,y<w){rt=i.get_played_result(g,e);for(s in rt.item_list)if(rt.item_list[s]<r[s]){p=!0;break}p&&(y+=1,setTimeout(b,0))}else console.log("LP-solve failed "+w+"times.");if(!p){st=i.get_played_result_items(o);ut={};for(s in r)ft=r[s]-st[s],ft>0&&(ut[s]=ft,nt&&(nt=!1));v.target_items=ut;v.best=d;nt?(c=i.get_played_result(o,e),f&&f({times_list:o,AP:c.AP,item_list:c.item_list})):ht(function(){var r,n,t;for(r in u)for(n in u[r].quest_times)for(t in u[r].quest_times[n])u[r].quest_times[n][t]>0&&(o[n]||(o[n]={}),o[n][t]=o[n][t]?o[n][t]:0,o[n][t]+=u[r].quest_times[n][t]);c=i.get_played_result(o,e);f&&f({times_list:o,AP:c.AP,item_list:c.item_list})})}}function st(n){var t=[],i,h=[],s,r,f,e,u,o;t.push("Minimize ");i=[];for(u in n.team.quest_list)r=n.team.quest_list[u],s=n.quest_list[r[0]][r[1]].AP,i.push(s+"Q"+u),h.push("Q"+u);t.push(i.join("+"));t.push(" subject to \n");for(u in n.team.item_list){i=[];f=n.team.item_list[u];for(o in n.team.quest_list)r=n.team.quest_list[o],e=n.quest_list[r[0]][r[1]].drop_list[f],e&&i.push(e+"Q"+o);t.push(i.join("+"));t.push(">="+n.target_items[f]+"\n")}return t.join("")}function d(t){a.push(t);n+=1;n<l?k():ot()}function ht(t){u.length=0;n=0;p=t;g()}function g(){var i={};for(index in t[n].item_list)item=t[n].item_list[index],i[item]=v.target_items[item];o.postMessage({team:t[n],quest_list:h,item2quest_list:c,target_items:i,event:e,best:v.best,isWebSite:FGO.isWebSite})}function nt(t){n+=1;u.push(t);n<l?g():p&&p()}var h={},r={},c={},e={},i=null,o,s;const w=10;let y;var t=[],n=null,l=null,a=[],u=[],f=null,p=null,v={target_items:null,best:null};return FGO.isWebSite?(o=new Worker("/FGO/release/FGO.js/FGO.PSO.min.js?"+FGO.ver),o.onmessage=function(n){nt(n.data)},s=new Worker("/FGO//release/LP_worker.min.js?"+FGO.ver),s.onmessage=function(n){d(n.data)}):(o=new Worker("/release/FGO.js/FGO.PSO.js?"+FGO.ver),o.onmessage=function(n){nt(n.data)},s=new Worker("/release/LP_worker.js?"+FGO.ver),s.onmessage=function(n){d(n.data)}),{set_event_status:it,set_target_item_list:rt,set_quest_manager:tt,get_result:et}}();