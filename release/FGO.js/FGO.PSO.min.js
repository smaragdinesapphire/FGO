self.addEventListener("message",function(n){function r(n,t){for(var r,u={},i=0,f=t.quest_list.length;i<f;i+=1)r=t.quest_list[i],u[r[0]]||(u[r[0]]={}),u[r[0]][r[1]]=n[i];return u}var h,u;typeof JIE=="undefined"&&(importScripts("/FGO/release/JIE.js/JIE.min.js"),importScripts("/FGO/release/JIE.js/JIE.base.min.js"),importScripts("/FGO/release/JIE.js/JIE.math.min.js"),importScripts("/FGO/release/JIE.js/JIE.optimization/JIE.optimization.PSO.min.js"),importScripts("/FGO/release/FGO.js/FGO.min.js"),importScripts("/FGO/release/FGO.js/FGO.info_manager.min.js"),importScripts("/FGO/release/FGO.js/FGO.info.min.js"));var t=n.data,o=t.team,f=t.quest_list,e=t.item2quest_list,i=t.target_items,c=t.event,s=FGO.info_manager,l=function(n){function o(){var t={};return t.length=n.quest_list.length,t.get_fit=function(){var t=r(arguments,n);return s.get_played_result_AP(t,c)},t}function h(){var s=[],u,h,e,t,o,r,c;for(h in n.quest_list){u=n.quest_list[h];e=f[u[0]][u[1]];t=null;for(c in n.item_list)r=n.item_list[c],e.drop_list[r]&&(o=Math.ceil(i[r]/e.drop_list[r]),(!t||t<o)&&(t=o));s.push({min:0,max:t})}return s}function l(){for(var r=[],i=0,u=n.quest_list.length;i<u;i+=1)r.push(Math.ceil(t.bound[i].max/10));return r}function u(t,u){var o,l,a,v={},y,h=[],c,p;JIE.base.extend(h,t);for(o in h)h[o]<u[o].min&&(h[o]=u[o].min),h[o]>u[o].max&&(h[o]=u[o].max);v=s.get_played_result_items(r(h,n));for(c in i)if((v[c]||0)<i[c]){if(!e[c]||!e[c].length)continue;y=i[c]-(v[c]||0);l=e[c][0].type;a=f[l[0]][l[1]];for(o in n.quest_list)if(n.quest_list[o].toString()===l.toString()){h[o]+=Math.ceil(y/a.drop_list[c]);p=h[o]*a.drop_list[c];break}}return h}function a(){var e=[],s,i,o;for(s in n.quest_list)e.push(0);return i=u(e,t.bound),o=function(n){var r=0,u=null,t,i,e;for(t in n)for(i in n[t])u=f[t][i],e=n[t][i],r+=u.AP*e;return r}(r(i,n)),{args:i,fit:o}}var t={};return t.fn=o(),t.bound=h(),t.v_max=l(),t.fixed_method=u,t.is_integer=!0,t.is_minimazation=!0,t.g_best=a(),t.p_max=40,t.iter_max=4e3,t.no_change_limit=20,t}(o);h=new JIE.optimization.PSO(l);u=h.play();u.quest_times=r(u.args,o);self.postMessage(u)},!1);