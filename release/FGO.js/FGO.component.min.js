FGO.component={};FGO.component.factory=function(n,t){var i=n;if(typeof FGO.component[n]!="function")throw{name:"Error",message:i+" doesn't exist"};return new FGO.component[i](t)};FGO.component.Item_grid=function(n){this._options={class_name:"item_grid",read_only:!1};JIE.base.marge(this._options,n);this._class_name=this._options.class_name;this._read_only=this._options.read_only;this._header=null;this._content=null;this._body=null;this._row_list={};this._item_list={};this._language=null;FGO.component.Item_grid.uber.constructor.call(this);this.onClick=new JIE.event.Publisher("click",this)};JIE.base.inherit(FGO.component.Item_grid,JIE.component.Control_base,{prepareNode:function(n){this._body=n;this._body.className=this._class_name;this._language=FGO.language_manager;this._header=NewObj("div","header");this._row_list.header={dom_list:{name:NewObj("div","c1",this._language.get_word("アイテム")),quest:NewObj("div","c2",this._language.get_word("クエスト")),count:NewObj("div","c3",this._language.get_word("数量")),row:this._header},name:this._language.get_word("アイテム"),quest:this._language.get_word("クエスト"),count:this._language.get_word("数量")};this._header.appendChild(this._row_list.header.dom_list.name);this._header.appendChild(this._row_list.header.dom_list.quest);this._header.appendChild(this._row_list.header.dom_list.count);n.appendChild(this._header)},add_item:function(n){var f=this,r,t,i,u;i=NewObj("button","button","?");i.value=n;this._row_list[n]={dom_list:null,name:n,quest:i,count:null};this._item_list[n]=1;this._read_only?r=NewObj("div","c3",""):(u=FGO.component.factory("Num_input",{min:0,max:99999}),r=NewObj("div","c3"),u.render(r),this._row_list[n].count=u);t=NewObj("div");this._body.appendChild(t);this._row_list[n].dom_list={name:NewObj("div","c1",n),quest:NewObj("div","c2",i),count:r,row:t};t.appendChild(this._row_list[n].dom_list.name);t.appendChild(this._row_list[n].dom_list.quest);t.appendChild(this._row_list[n].dom_list.count);i.onclick=function(){f.onClick.fire(this.value)}},set_value:function(n,t){var i=this._row_list[n],r;return i?(this._read_only?(r=Math.floor(t*1e3)/1e3,i.dom_list.count.innerText=r,i.count=r):i.count.set_value(t),!0):!1},get_result:function(){var t={};for(var n in this._row_list)n!=="header"&&(t[n]=this._read_only?this._row_list[n].value:this._row_list[n].count.get_value());return t},get_item_list:function(){return this._item_list},refresh_state:function(n){if(this._read_only){var t,i;for(t in this._row_list)t!=="header"&&(i=this._language.get_JP_word(t),this._row_list[t].dom_list.row.className=n[i]?n[i]>this._row_list[t].count?"not_enough":"enough":"is_not_target")}},reset:function(){for(var n in this._row_list)n!=="header"&&this.set_value(n,0)},add_header_class:function(n){this._header.classList.add(n)},get_column_width:function(){var u,i,n,t={},r;for(u in this._row_list){i=this._row_list[u].dom_list;for(n in i)n!=="row"&&(r=i[n].clientWidth-10,(!t[n]||t[n]<r)&&(t[n]=r))}return t},set_column_width:function(n){var r,t,i;for(r in this._row_list){t=this._row_list[r].dom_list;for(i in t)t[i].style.width=n[i]+2+"px"}}});FGO.component.Num_input=function(n){var t=this;this._options=n||{};this._body=NewObj("input");this._body.type="text";this._body.value="0";this._backup=0;this._body.addEventListener("blur",function(){if(this.value===""){this.value=t._backup;return}var n=Number(this.value);isNaN(n)?this.value=t._backup:(typeof t._options.min=="number"&&this.value<t._options.min&&(n=t._options.min),typeof t._options.max=="number"&&this.value>t._options.max&&(n=t._options.max),t._backup=this.value=n)});this._body.addEventListener("click",function(){this.value=""});this._body.addEventListener("focus",function(){this.value=""})};FGO.component.Num_input.prototype.get_value=function(){return Number(this._body.value)};FGO.component.Num_input.prototype.render=function(n){n.appendChild(this._body)};FGO.component.Num_input.prototype.set_value=function(n){this._body.value=n};FGO.component.Container=function(n){this._options={class_name:"container",title:"unknown"};JIE.base.marge(this._options,n);this._body=null;this._title_text=null;this._content=null;this._class_name=this._options.class_name;this._title=this._options.title;this._content_area=null;this._max_height=null;FGO.component.Container.uber.constructor.call(this)};JIE.base.inherit(FGO.component.Container,JIE.component.Control_base,{prepareNode:function(n){this._body=n;n.className=this._class_name;var u=this,t=NewObj("div","title"),i=NewObj("div","icon","▼"),r=!0;t.onclick=function(){r?(r=!1,i.innerText="▲",u._content_area.classList.add("slideUp")):(r=!0,i.innerText="▼",u._content_area.classList.remove("slideUp"))};this._title_text=NewObj("div","text",this._title);t.appendChild(this._title_text);t.appendChild(i);this._content=NewObj("div","content");this._content_area=NewObj("div","content_area");this._content_area.appendChild(this._content);this._body.appendChild(t);this._body.appendChild(this._content_area)},add_content:function(n){typeof n.render=="function"?n.render(this._content):this._content.appendChild(n)},auto_set_max_height:function(){this._max_height=this._content.clientHeight;this._content_area.style.maxHeight=this._max_height+"px"},clear_max_height:function(){this._max_height="";this._content_area.style.maxHeight=""}});FGO.component.Other=function(n){this._options={class_name:"other"};JIE.base.marge(this._options,n);this._class_name=this._options.class_name;this._body=null;this._item_collecter=[];this._event_ul=null;this._schedule=null;this._schedule_list={};this._schedule_area=null;this._count=0;this._schedule_first_options=null;FGO.component.Other.uber.constructor.call(this);this.onChange=new JIE.event.Publisher("change",this)};JIE.base.inherit(FGO.component.Other,JIE.component.Control_base,{prepareNode:function(n){var r,t,i;this._body=n;n.className=this._class_name;r=FGO.language_manager;t=NewObj("div","event_area");this._event_ul=NewObj("ul","event");t.appendChild(NewObj("div","title",r.get_word("イベント")));t.appendChild(this._event_ul);i=NewObj("div","schedule_area");i.appendChild(NewObj("div","title",r.get_word("進行度")));this._schedule=NewObj("select","select");i.appendChild(this._schedule);this._body.appendChild(t);this._body.appendChild(i)},add_event_item:function(n){var r;if(typeof n=="string"&&n.trim()!==""){this._count+=1;var u=this,i=NewObj("li","item"),t=NewObj("input");t.type="checkbox";t.value=n;t.id="item_"+this._count;t.onclick=function(){u.onChange.fire(u.get_result().event)};r=NewObj("label","text",n);r.htmlFor=t.id;i.appendChild(t);i.appendChild(r);this._event_ul.appendChild(i);this._item_collecter[n]=t}},add_schedule_option:function(n){if(typeof n=="string"&&n.trim()!==""){var t=NewObj("option","",n);this._schedule.appendChild(t);this._schedule_list[n]=t;this._schedule_first_options||(this._schedule_first_options=t,t.selected=!0)}},get_result:function(){var n={event:{},schedule:null};for(var t in this._item_collecter)n.event[t]=this._item_collecter[t].checked?1:0;return n.schedule=this._schedule.value,n},set_event_status:function(n){for(var t in n)this._item_collecter[t].checked=n[t]?!0:!1},select_schedule:function(n){this._schedule_list[n].selected="selected"},reset:function(){for(var n in this._item_collecter)this._item_collecter[n].checked=!1;this._schedule_first_options.selected="selected"}});FGO.component.Dialog=function(n){function i(){this.c1=null;this.c2=null;this.c3=null;this.c4=null;this.c5=null;this.body=null}this._options={class_name:"dialog"};JIE.base.marge(this._options,n);var t=FGO.language_manager;this._dialog=JIE.component.Dialog.factory("simple");this._dialog.change_class_name(this._options.class_name);this._row_list=[];this.set_content=function(n){var o=NewObj("div"),r,u,s,h,c,l,e,f;this._dialog.set_content(o);this._dialog.set_title(t.get_word(n.item_name));r=new i;r.c1=NewObj("div","c1",t.get_word("エリア"));r.c2=NewObj("div","c2",t.get_word("クエスト"));r.c3=NewObj("div","c3","AP");r.c4=NewObj("div","c4",t.get_word("ドロップ率"));r.c5=NewObj("div","c5",t.get_word("ドロップ率 / AP"));r.body=NewObj("div","header");r.finish_append();o.appendChild(r.body);this._row_list.push(r);f=n.list;for(e in f)s=f[e].type,h=f[e].AP,c=Math.round(f[e].CP*1e3)/1e3,l=Math.round(f[e].P*1e5)/1e3+"%",u=new i,u.c1=NewObj("div","c1",t.get_word(s[0])),u.c2=NewObj("div","c2",t.get_word(s[1])),u.c3=NewObj("div","c3",h),u.c4=NewObj("div","c4",l),u.c5=NewObj("div","c5",c),u.body=NewObj("div","row"),u.finish_append(),o.appendChild(u.body),this._row_list.push(u)};this.show=function(){this._dialog.show()};this.hide=function(){this._dialog.hide()};this.render=function(n){this._dialog.render(n)};this.refresh=function(){var t,i={},r,n,u;for(t in this._row_list){r=this._row_list[t];for(n in r)/^c\d+$/.test(n)&&(u=Math.ceil(r[n].clientWidth-10),(!i[n]||i[n]<u)&&(i[n]=u))}for(t in this._row_list)for(n in this._row_list[t])/^c\d+$/.test(n)&&(this._row_list[t][n].style.minWidth=i[n]+2+"px")};i.prototype.finish_append=function(){this.body.appendChild(this.c1);this.body.appendChild(this.c2);this.body.appendChild(this.c3);this.body.appendChild(this.c4);this.body.appendChild(this.c5)}};FGO.component.Header=function(n){this._options={class_name:"header_panel",language:"JP"};JIE.base.marge(this._options,n);this._body=null;this._select=null;this.onChange=new JIE.event.Publisher("change",this);FGO.component.Header.uber.constructor.call(this)};JIE.base.inherit(FGO.component.Header,JIE.component.Control_base,{prepareNode:function(n){var i=this,r=FGO.language_manager,t;this._body=n;n.className=this._options.class_name;n.id=this._options.class_name;t=NewObj("div","language_area");n.appendChild(t);t.appendChild(NewObj("div","text",r.get_word("言語")));this._select=NewObj("select");t.appendChild(this._select);this._select.onchange=function(){i.onChange.fire(this.value)}},set_language_list:function(n){for(var t,i;this._select.firstChild;)this._select.removeChild(this._select.firstChild);for(i in n)t=NewObj("option","option",n[i].name),t.value=n[i].value,this._select.appendChild(t)},set_language:function(n){this._select.value=n}});FGO.component.Item_container=null,function(){var n=FGO.component.factory;FGO.component.Item_container=function(t){this._options={container_class_name:"container",item_grid_class_name:"item_grid",title:null,read_only:!1};JIE.base.marge(this._options,t);this._container=n("Container",{class_name:this._options.container_class_name,title:this._options.title});this._item_grid_list=[];this.onInfoClick=new JIE.event.Publisher("infoClick",this)};FGO.component.Item_container.prototype.add_item_grid=function(t,i){var f=this,r=n("Item_grid",{class_name:this._options.item_grid_class_name,read_only:this._options.read_only}),u;r.add_header_class(i);for(u in t)r.add_item(t[u]);this._item_grid_list.push(r);this._container.add_content(r);r.onClick.subscribe(function(n,t){f.onInfoClick.fire(t[0])})};FGO.component.Item_container.prototype.get_result=function(){var n={};for(var t in this._item_grid_list)JIE.base.margeDeep(n,this._item_grid_list[t].get_result());return n};FGO.component.Item_container.prototype.set_value=function(n){var t,i,r;for(i in this._item_grid_list){r=this._item_grid_list[i].get_item_list();for(t in r)n[t]&&this._item_grid_list[i].set_value(t,n[t])}};FGO.component.Item_container.prototype.refresh_state=function(n){var t;if(this._options.read_only)for(t in this._item_grid_list)this._item_grid_list[t].refresh_state(n)};FGO.component.Item_container.prototype.reset=function(){for(var n in this._item_grid_list)this._item_grid_list[n].reset()};FGO.component.Item_container.prototype.render=function(n){this._container.render(n)};FGO.component.Item_container.prototype.auto_set_max_height=function(){this._container.auto_set_max_height()};FGO.component.Item_container.prototype.clear_max_height=function(){this._container.clear_max_height()};FGO.component.Item_container.prototype.get_column_width=function(){var r,u,n,i,t;for(r in this._item_grid_list)if(u=this._item_grid_list[r],i=u.get_column_width(),n)for(t in n)n[t]<i[t]&&(n[t]=i[t]);else n=i;return n};FGO.component.Item_container.prototype.set_column_width=function(n){for(var t in this._item_grid_list)this._item_grid_list[t].set_column_width(n)}}();FGO.component.Quest_times_grid=function(n){this._options={class_name:"quest_times_grid"};JIE.base.marge(this._options,n);this._class_name=this._options.class_name;this._header=null;this._content=null;this._body=null;this._row_list={};this._item_list={};FGO.component.Quest_times_grid.uber.constructor.call(this)};JIE.base.inherit(FGO.component.Quest_times_grid,JIE.component.Control_base,{prepareNode:function(n){this._body=n;this._body.className=this._class_name;var t=FGO.language_manager;this._header=NewObj("div","header");this._row_list.header={area:NewObj("div","c1",t.get_word("エリア")),quest:NewObj("div","c2",t.get_word("クエスト")),count:NewObj("div","c3",t.get_word("タイムズ"))};this._row_list.header={dom_list:{area:NewObj("div","c1",t.get_word("エリア")),quest:NewObj("div","c2",t.get_word("クエスト")),count:NewObj("div","c3",t.get_word("タイムズ"))}};this._header.appendChild(this._row_list.header.dom_list.area);this._header.appendChild(this._row_list.header.dom_list.quest);this._header.appendChild(this._row_list.header.dom_list.count);n.appendChild(this._header)},add_quest_times_list:function(n){this._clear();var t,i,r;for(t in n)for(i in n[t])n[t][i]&&(this._row_list[t+i]={dom_list:{area:NewObj("div","c1",t),quest:NewObj("div","c2",i),count:NewObj("div","c3",n[t][i]),row:r},area:t,quest:i,count:n[t][i]},r=NewObj("div"),r.appendChild(this._row_list[t+i].dom_list.area),r.appendChild(this._row_list[t+i].dom_list.quest),r.appendChild(this._row_list[t+i].dom_list.count),this._body.appendChild(r),this._row_list[t+i].dom_list.row=r)},_clear:function(){for(var n in this._row_list)n!=="header"&&(this._body.removeChild(this._row_list[n].dom_list.row),delete this._row_list[n])},get_column_width:function(){var u,i,n,t={},r;for(u in this._row_list){i=this._row_list[u].dom_list;for(n in i)n!=="row"&&(r=i[n].clientWidth-10,(!t[n]||t[n]<r)&&(t[n]=r))}return t},set_column_width:function(n){var r,t,i;for(r in this._row_list){t=this._row_list[r].dom_list;for(i in t)t[i].style.width=n[i]+2+"px"}}});