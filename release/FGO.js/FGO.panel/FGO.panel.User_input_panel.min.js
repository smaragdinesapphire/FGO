FGO.panel.User_input_panel=function(n){this._options={class_name:"user_input_panel"};JIE.base.marge(this._options,n);this._body=null;this._container_list=[];this.onInfoClick=new JIE.event.Publisher("infoClick",this);this.onOtherChange=new JIE.event.Publisher("otherChange",this);this.onCalculate=new JIE.event.Publisher("calculate",this);this.onSave=new JIE.event.Publisher("save",this);this.onLoad=new JIE.event.Publisher("load",this);this.onReset=new JIE.event.Publisher("reset",this);FGO.panel.User_input_panel.uber.constructor.call(this)};JIE.base.inherit(FGO.panel.User_input_panel,JIE.component.Control_base,{_language:null,prepareNode:function(n){var f,t,u;this._body=n;n.className=this._options.class_name;n.id=this._options.class_name;f=FGO.component.factory;t=FGO.language_manager;this._language=t;u=f("Container",{class_name:"container",title:t.get_word("コンフィグ")});u.render(n);this._container_list.main=u;var i=this,o=FGO.info_manager.get_item_list(),s=FGO.info_manager.get_event_list(),h=FGO.info_manager.get_schedule_list(),r,c,e;rare_type=["bronze","silver","golden"],function(n){e=t.get_word("輝石")+" & "+t.get_word("魔石")+" & "+t.get_word("秘石");r=f("Item_container",{read_only:!1,title:e});i._container_list.stone=r;n.add_content(r);i._list_creater(r,["stone"],o);r.onInfoClick.subscribe(function(n,r){i.onInfoClick.fire(t.get_JP_word(r[0]))})}(u),function(n){e=t.get_word("ピース")+" & "+t.get_word("モニュ");r=f("Item_container",{read_only:!1,title:e});i._container_list.chess=r;n.add_content(r);i._list_creater(r,["chess"],o);r.onInfoClick.subscribe(function(n,r){i.onInfoClick.fire(t.get_JP_word(r[0]))})}(u),function(n){c=["other"];e=t.get_word("銅素材")+" & "+t.get_word("銀素材")+" & "+t.get_word("金素材");r=f("Item_container",{read_only:!1,title:e});i._container_list.material=r;n.add_content(r);i._list_creater(r,["other"],o);r.onInfoClick.subscribe(function(n,t){i.onInfoClick.fire(t[0])})}(u),function(n){var u=f("Container",{class_name:"container",title:t.get_word("イベント")+" & "+t.get_word("進行度")}),r=f("Other");for(var e in s)r.add_event_item(t.get_word(s[e]));r.onChange.subscribe(function(n,r){var u={};for(var f in r[0])u[t.get_JP_word(f)]=r[0][f];i.onOtherChange.fire(u)});for(e in h)r.add_schedule_option(t.get_word(h[e]));u.add_content(r);i._container_list.other_setting=r;i._container_list.other_setting_container=u;n.add_content(u)}(u),function(n){var r=NewObj("div","btn_area"),o=NewObj("button","save",t.get_word("セーブ")),u,f,e;o.onclick=function(){i._save()};u=NewObj("button","load",t.get_word("ロード"));u.onclick=function(){i._load()};f=NewObj("button","calculate",t.get_word("計算"));f.onclick=function(){i._calculate()};e=NewObj("button","reset",t.get_word("リセット"));e.onclick=function(){i.onReset.fire(i._options.class_name);i._reset()};r.appendChild(o);r.appendChild(u);r.appendChild(f);r.appendChild(e);n.add_content(r)}(u)},_save:function(){this.onSave.fire(this.get_result())},_load:function(){this.onLoad.fire()},_list_creater:function(n,t,i){var u,r,f,e;for(u in t)for(r in rare_type)if(i[t[u]][rare_type[r]]){e=[];for(f in i[t[u]][rare_type[r]])e[f]=this._language.get_word(i[t[u]][rare_type[r]][f]);n.add_item_grid(e,rare_type[r])}},_calculate:function(){this.onCalculate.fire()},get_result:function(){var t={},i,r;for(var n in this._container_list)typeof this._container_list[n].get_result=="function"&&n!=="other_setting"&&(r=this._container_list[n].get_result(),JIE.base.marge(t,r));return i=this._container_list.other_setting.get_result(),{item_list:t,other_setting:i}},set_user_setting:function(n){var t,i=["stone","chess","material"];for(t in i)this._container_list[i[t]].reset(),this._container_list[i[t]].set_value(n.item_list);this._container_list.other_setting.set_event_status(n.other_setting.event);this._container_list.other_setting.select_schedule(n.other_setting.schedule)},refresh:function(){var t={},i,r;for(var n in this._container_list)if(typeof this._container_list[n].get_column_width=="function")if(i=this._container_list[n].get_column_width(),t[n])for(r in i)t[n][r]<i[r]&&(t[n][r]=i[r]);else t[n]=i;for(n in this._container_list)typeof this._container_list[n].set_column_width=="function"&&this._container_list[n].set_column_width(t[n])},_reset:function(){var n,t=["stone","chess","material"];for(n in t)this._container_list[t[n]].reset();this._container_list.other_setting.reset()}});