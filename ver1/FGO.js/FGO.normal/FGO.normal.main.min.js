FGO.normal.main=function(){function lt(){for(var n in i)i[n].value=0;for(n in s)s[n].value=0;y.value=b}function at(){var r,f,u=!1;n={};n.target_item={};n.event={};n.schedule=null;for(r in i)i[r].value>0&&(n.target_item[r]=i[r].value,u||(u=!0));for(r in s)s[r].value>0&&(n.target_item[r]=s[r].value,u||(u=!0));for(t=0,v=tt.children.length;t<v;t++)f=tt.children[t],f.type==="checkbox"&&f.checked&&(n.event[f.value]=1);return n.schedule=y.value,u}function vt(n){for(var u=e.chess_and_stone.name_list,f=e.chess_and_stone.class_list,a=u.length,r,v=f.length,t,s,h,c,o,l={},i=0;i<a;i+=1){for(o=NewObj("table","grid"),t=NewObj("tr","tr"),t.appendChild(NewObj("td","header","名稱")),t.appendChild(NewObj("td","header","數量")),o.appendChild(t),r=0;r<v;r+=1)t=NewObj("tr","tr"),h=et(),s=NewObj("td","",NewObj("span","",f[r]+u[i])),c=NewObj("div","question","?"),c.value=f[r]+u[i],s.appendChild(c),t.appendChild(s),t.appendChild(NewObj("td","",h)),l[f[r]+u[i]]=h,o.appendChild(t);n.appendChild(o)}return n.addEventListener("click",function(){var n=event.target;n.classList.contains("question")&&d(n.value)}),l}function yt(n){function o(n,t){for(var r,u,f,e,s={},i=0,o=t.length;i<o;i++)r=NewObj("tr"),u=NewObj("td","",NewObj("span","",t[i])),e=NewObj("div","question","?"),e.value=t[i],u.appendChild(e),f=et(),r.appendChild(u),r.appendChild(NewObj("td","",f)),n.appendChild(r),s[t[i]]=f;return s}var l=e.other_items.copper,a=e.other_items.silver,v=e.other_items.gold,t,s,h,c,i={},f=NewObj("table","copper grid"),r,u;return t=NewObj("tr"),t.appendChild(NewObj("td","header","銅素材名稱")),t.appendChild(NewObj("td","header","數量")),f.appendChild(t),s=o(f,l),r=NewObj("table","silver grid"),t=NewObj("tr"),t.appendChild(NewObj("td","header","銀素材名稱")),t.appendChild(NewObj("td","header","數量")),r.appendChild(t),h=o(r,a),u=NewObj("table","gold grid"),t=NewObj("tr"),t.appendChild(NewObj("td","header","金素材名稱")),t.appendChild(NewObj("td","header","數量")),u.appendChild(t),c=o(u,v),n.appendChild(f),n.appendChild(r),n.appendChild(u),JIE.base.marge(i,s),JIE.base.marge(i,h),JIE.base.marge(i,c),n.addEventListener("click",function(){var n=event.target;n.classList.contains("question")&&d(n.value)}),i}function et(){var n=NewObj("input"),t;return n.type="text",n.value="0",t=0,n.addEventListener("change",function(){var n=Number(this.value);isNaN(n)?this.value=t:t=this.value=n>=0?n:0}),n}function pt(n,t){for(var r,i=0,u=t.length;i<u;i++)r=NewObj("option","",t[i]),r.value=t[i],n.appendChild(r);return n}function wt(t){for(var p,h,g,y,w,e,u,k,s,v,i,b,nt;l.firstChild;)l.removeChild(l.firstChild);while(a.firstChild)a.removeChild(a.firstChild);result.classList.remove("hide");ot.innerText=t.AP;p=NewObj("table","grid");h=NewObj("tr");h.appendChild(NewObj("td","header","種類"));h.appendChild(NewObj("td","header","區域"));h.appendChild(NewObj("td","header","副本"));h.appendChild(NewObj("td","header","次數"));l.appendChild(p);p.appendChild(h);k=["每日任務"].concat(c);for(g in k){i=k[g];for(y in t.quest_count_list[i])for(w in t.quest_count_list[i][y])t.quest_count_list[i][y][w]!==0&&(e=NewObj("tr"),e.appendChild(NewObj("td","",i)),e.appendChild(NewObj("td","",y)),e.appendChild(NewObj("td","",w)),e.appendChild(NewObj("td","",t.quest_count_list[i][y][w])),p.appendChild(e))}for(f===null&&(f=o.querySelector(".target_item").cloneNode(!0)),e=f.querySelectorAll("tr"),i=0,b=e.length;i<b;i+=1)(u=e[i].querySelectorAll("td"),u[0].classList.contains("header"))||(s=u[0].querySelector("span").innerText,u[0].classList.remove("no_enough"),u[0].classList.remove("finish"),t.item_list[s]?n.target_item[s]?(u[0].classList.add("finish"),u[1].innerText=Math.round(t.item_list[s]*1e3)/1e3):u[1].innerText=Math.round(t.item_list[s]*100)/100:n.target_item[s]?(u[0].classList.add("not_enough"),u[1].innerText=n.target_item[s]*-1):u[1].innerText=0);for(a.appendChild(f),v=r.querySelectorAll(".unfold_btn"),i=0,b=v.length;i<b;i+=1)nt=v[i].parentNode.parentNode.querySelector(".grid_area"),nt.className="grid_area unfold",v[i].value="0",v[i].innerText="-",v[i].onclick=function(){var n=this.parentNode.parentNode.querySelector(".grid_area");n.classList.toggle("unfold");n.classList.toggle("fold");this.value==="1"?(this.value="0",this.innerText="-"):(this.value="1",this.innerText="+")};f.addEventListener("click",function(){var n=event.target;n.classList.contains("question")&&d(event.target.parentNode.querySelector("span").innerText)})}function d(n){var r=NewObj("table","grid"),e,t,f,i;t=NewObj("tr");t.appendChild(NewObj("td","header","種類"));t.appendChild(NewObj("td","header","區域"));t.appendChild(NewObj("td","header","副本"));t.appendChild(NewObj("td","header","AP"));t.appendChild(NewObj("td","header","掉落率"));t.appendChild(NewObj("td","header","1個/AP"));r.appendChild(t);for(e in nt[n])f=nt[n][e],i=f.type,t=NewObj("tr"),t.appendChild(NewObj("td","",i[0])),t.appendChild(NewObj("td","",i[1])),t.appendChild(NewObj("td","",i[2])),t.appendChild(NewObj("td","",g[i[0]][i[1]][i[2]].AP)),t.appendChild(NewObj("td","",Math.round(g[i[0]][i[1]][i[2]].drop[n]*1e3)/1e3)),t.appendChild(NewObj("td","",Math.round(f.CP*1e3)/1e3)),r.appendChild(t);u.set_title(n);u.set_contain(r);u.show()}var h=FGO.normal.quest_data_manager(),g=h.get_all_quest_list(),c=h.get_schedule(),e=h.get_item_list(),nt=h.get_item2quest_list(),o=document.querySelector("#user_input"),i=vt(o.querySelector(".chess .grid_area")),s=yt(o.querySelector(".item .grid_area")),y=pt(o.querySelector(".schedule"),c),tt=document.querySelector("#user_input .event"),r=document.querySelector("#result"),ct,u,f,p,t,v,w,it,rt,n,b,ut,ft,k;r.classList.add("hide");var l=r.querySelector(".quest .grid_area"),a=r.querySelector(".item"),ot=r.querySelector(".AP_result"),st=NewObj("table","grid_area"),ht=NewObj("div","not_enough",NewObj("span","title_2","無法獲得物品數"));for(ht.appendChild(st),ct=!1,u=JIE.component.dialog.factory("simple"),u.render(document.body),u.hide(),f=null,p=o.querySelectorAll(".unfold_btn"),t=0,v=p.length;t<v;t+=1)p[t].onclick=function(){var n=this.parentNode.parentNode.querySelector(".grid_area");n.classList.toggle("unfold");n.classList.toggle("fold");this.value==="1"?(this.value="0",this.innerText="-"):(this.value="1",this.innerText="+")};if(w=new FGO.ui.processing_dialog,JIE.debug){it=0;for(rt in i)i[rt].value=1,it+=1}n={};n.target_item={};n.event={};n.schedule=null;b=c[c.length-1];y.value=b;ut=document.querySelector("#user_input .reset");ft=document.querySelector("#user_input .start");ut.onclick=function(){lt()};ft.onclick=function(){var i=at(),t=null;i&&(w.render(document.body),setTimeout(function(){k.set_data(n);t=k.get_minimization();wt(t);r.classList.remove("hide");setTimeout(function(){w.unrender(document.body);window.scrollTo(0,r.scrollHeight)},2e3)},500))};k=FGO.normal.minimized_method()};window.onload=function(){FGO.normal.main()};